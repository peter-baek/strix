import { Link } from 'react-router-dom';
import type { Vulnerability } from '../types';

interface VulnerabilitySummaryProps {
  vulnerabilities: Vulnerability[];
  scanId: string;
}

export default function VulnerabilitySummary({ vulnerabilities, scanId }: VulnerabilitySummaryProps) {
  const counts = {
    critical: vulnerabilities.filter(v => v.severity === 'critical').length,
    high: vulnerabilities.filter(v => v.severity === 'high').length,
    medium: vulnerabilities.filter(v => v.severity === 'medium').length,
    low: vulnerabilities.filter(v => v.severity === 'low').length,
    info: vulnerabilities.filter(v => v.severity === 'info').length,
  };

  const severityConfig = [
    { key: 'critical', label: 'Critical', color: 'bg-severity-critical', textColor: 'text-severity-critical' },
    { key: 'high', label: 'High', color: 'bg-severity-high', textColor: 'text-severity-high' },
    { key: 'medium', label: 'Medium', color: 'bg-severity-medium', textColor: 'text-severity-medium' },
    { key: 'low', label: 'Low', color: 'bg-severity-low', textColor: 'text-severity-low' },
    { key: 'info', label: 'Info', color: 'bg-severity-info', textColor: 'text-severity-info' },
  ] as const;

  return (
    <div className="bg-strix-surface border border-strix-border rounded-lg p-4">
      <div className="flex items-center justify-between mb-3">
        <h3 className="text-sm font-semibold text-strix-text-secondary">Vulnerabilities</h3>
        <span className="text-xs text-strix-text-muted">{vulnerabilities.length} total</span>
      </div>

      <div className="space-y-2">
        {severityConfig.map(({ key, label, color, textColor }) => (
          <div key={key} className="flex items-center gap-2">
            <div className={`w-2 h-2 rounded-full ${color}`} />
            <span className="text-xs text-strix-text-secondary flex-1">{label}</span>
            <span className={`text-sm font-bold ${textColor}`}>
              {counts[key]}
            </span>
          </div>
        ))}
      </div>

      {vulnerabilities.length > 0 && (
        <Link
          to={`/scan/${scanId}/vulnerabilities`}
          className="mt-3 block text-center text-xs text-accent-green hover:text-accent-green/80 transition-colors"
        >
          View Reports â†’
        </Link>
      )}
    </div>
  );
}
